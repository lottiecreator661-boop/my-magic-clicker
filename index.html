<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON EMPIRE ELITE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --accent: #0098EA; --bg: #0b0f1a; --glass: rgba(255, 255, 255, 0.1); }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        .header { padding: 15px 20px; background: rgba(0,0,0,0.4); border-bottom: 1px solid var(--accent); display: flex; justify-content: space-between; align-items: center; }
        .balance { font-size: 26px; font-weight: 900; color: var(--accent); text-shadow: 0 0 10px var(--accent); }
        .online { color: #10b981; font-size: 11px; font-weight: bold; }

        .tab-content { flex-grow: 1; display: none; padding: 20px; overflow-y: auto; padding-bottom: 100px; }
        .active { display: flex; flex-direction: column; align-items: center; }

        /* –ö–û–ò–ù */
        #coin { width: 220px; height: 220px; background: var(--accent); border-radius: 50%; margin: 40px auto; display: flex; align-items: center; justify-content: center; font-size: 70px; cursor: pointer; box-shadow: 0 0 30px var(--accent); border: 5px solid rgba(255,255,255,0.2); transition: 0.1s; }
        #coin:active { transform: scale(0.95); }

        /* –ö–ê–†–¢–û–ß–ö–ò */
        .card { background: var(--glass); border-radius: 20px; padding: 20px; width: 100%; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; }
        .btn { background: var(--accent); border: none; color: #fff; padding: 15px; border-radius: 12px; font-weight: bold; width: 100%; cursor: pointer; margin: 5px 0; }
        .input { background: #161b2a; border: 1px solid var(--accent); color: #fff; padding: 12px; border-radius: 10px; width: 90%; text-align: center; margin-bottom: 10px; }

        /* –í–ò–ü –ò –ê–î–ú–ò–ù */
        .vip-status { background: linear-gradient(45deg, #ffd700, #ffa500); color: #000; padding: 5px 15px; border-radius: 10px; font-weight: 900; font-size: 14px; margin-bottom: 10px; }
        .admin-btn { background: #ef4444 !important; }

        /* –ò–ì–†–´ */
        .wheel-container { width: 100%; height: 70px; background: #161b2a; border-radius: 15px; overflow: hidden; position: relative; margin: 15px 0; border: 2px solid var(--accent); }
        .wheel-track { display: flex; position: absolute; left: 0; transition: transform 4s cubic-bezier(0.1, 0, 0.1, 1); }
        .wheel-item { min-width: 50px; height: 50px; margin: 10px; background: var(--accent); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 22px; }

        .menu { position: fixed; bottom: 0; width: 100%; display: flex; background: #161b2a; padding: 10px 0 30px 0; border-top: 1px solid var(--accent); }
        .menu-item { flex: 1; text-align: center; font-size: 12px; color: #64748b; cursor: pointer; }
        .menu-item.active-nav { color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <div style="text-align: left;">
        <div class="online">‚óè ONLINE: <span id="onl-cnt">834</span></div>
        <div class="balance"><span id="bal">0.00</span> <small style="font-size:12px">TON</small></div>
    </div>
    <div style="text-align: right;">
        <div style="font-size: 14px; font-weight: bold;">‚ö° <span id="nrg">250</span></div>
    </div>
</div>

<div id="farm" class="tab-content active">
    <div id="coin">üíé</div>
    <div style="color: #94a3b8; font-size: 13px;" id="nrg-timer">–ó–∞—Ä—è–∂–µ–Ω–æ</div>
</div>

<div id="games" class="tab-content">
    <div id="g-list" style="width: 100%;">
        <div class="card" onclick="openG('mines')">üí£ –ú–ò–ù–´</div>
        <div class="card" onclick="openG('wheel')">üé° PvP –†–£–õ–ï–¢–ö–ê (JACKPOT)</div>
    </div>
    <div id="g-play" style="display:none; width: 100%;">
        <h2 id="g-title">–ò–ì–†–ê</h2>
        <div id="g-box"></div>
        <div id="g-info" style="color: #f59e0b; font-weight: bold; margin: 10px;"></div>
        <button id="cashout-btn" class="btn" style="background: #10b981; display: none;" onclick="doCashout()">–ó–ê–ë–†–ê–¢–¨</button>
        <button class="btn" style="background: #475569;" onclick="closeG()">–ù–ê–ó–ê–î</button>
    </div>
</div>

<div id="profile" class="tab-content">
    <div id="vip-box"></div>
    <div class="card">
        <h3>–ú–û–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê</h3>
        <p>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: <span id="stat-clk">0</span></p>
        <p>–°—Ç–∞—Ç—É—Å: <span id="stat-rank">–ò–≥—Ä–æ–∫</span></p>
    </div>
    <div class="card">
        <h3>–ö–í–ï–°–¢–´</h3>
        <div id="q-list"></div>
    </div>
    <button class="btn admin-btn" id="adm-btn" style="display: none;" onclick="openAdmin()">–ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</button>
    <button class="btn" onclick="db.vip = true; save(); location.reload();">–ö–£–ü–ò–¢–¨ VIP (–¢–ï–°–¢)</button>
</div>

<div class="menu">
    <div class="menu-item active-nav" onclick="tab('farm', this)">üíé<br>–ö–ª–∏–∫</div>
    <div class="menu-item" onclick="tab('games', this)">üé≤<br>–ò–≥—Ä—ã</div>
    <div class="menu-item" onclick="tab('profile', this)">üë§<br>–ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    const myId = tg.initDataUnsafe?.user?.id || 0;
    const ADMIN_ID = 123456789; // –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô ID

    function s(v, f=0) { let r = parseFloat(v); return isNaN(r) ? f : r; }

    let db = JSON.parse(localStorage.getItem('ton_pro_save')) || {
        bal: 100, nrg: 250, clk: 0, last: Date.now(),
        vip: false, jackpot_bet: 0, q1: false, q2: false
    };

    function save() { localStorage.setItem('ton_pro_save', JSON.stringify(db)); }

    function update() {
        let now = Date.now();
        let dt = (now - db.last) / 1000;
        
        let maxN = db.vip ? 1000 : 250;
        if(db.nrg < maxN) db.nrg = Math.min(maxN, db.nrg + (dt * 0.25));
        
        db.last = now;
        document.getElementById('bal').innerText = s(db.bal).toFixed(2);
        document.getElementById('nrg').innerText = Math.floor(s(db.nrg));
        document.getElementById('onl-cnt').innerText = Math.floor(Math.random()*40)+810;
        document.getElementById('stat-clk').innerText = db.clk;
        
        if(db.vip) {
            document.getElementById('vip-box').innerHTML = '<div class="vip-status">üëë VIP –°–¢–ê–¢–£–° –ê–ö–¢–ò–í–ï–ù</div>';
            document.getElementById('stat-rank').innerText = "VIP –ú–∞–≥–Ω–∞—Ç";
        }
        if(myId == ADMIN_ID) document.getElementById('adm-btn').style.display = 'block';

        renderQuests();
        save();
    }

    // –ö–õ–ò–ö
    document.getElementById('coin').onclick = () => {
        if(db.nrg >= 1) { db.nrg--; db.bal += 0.5; db.clk++; update(); }
    };

    // –¢–ê–ë–´
    function tab(id, el) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active-nav'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active-nav');
    }

    // –ò–ì–†–´
    let game = { active: false, bet: 0, mult: 1 };

    function openG(t) {
        document.getElementById('g-list').style.display = 'none';
        document.getElementById('g-play').style.display = 'block';
        let box = document.getElementById('g-box');
        if(t === 'wheel') {
            document.getElementById('g-title').innerText = "JACKPOT PvP";
            box.innerHTML = `
                <div class="wheel-container"><div id="w-track" class="wheel-track"></div></div>
                <div id="w-pot" style="font-size:20px; margin:10px;">–ë–∞–Ω–∫: 0.00 TON</div>
                <div id="w-ui">
                    <input id="w-bet" class="input" type="number" placeholder="–°—Ç–∞–≤–∫–∞">
                    <button class="btn" onclick="startW()">–ü–û–°–¢–ê–í–ò–¢–¨</button>
                </div>
            `;
            let tr = document.getElementById('w-track');
            for(let i=0; i<40; i++) tr.innerHTML += `<div class="wheel-item">${['üíé','üî•','üí∞','üëë'][i%4]}</div>`;
            if(db.jackpot_bet > 0) restoreW();
        } else if(t === 'mines') {
            document.getElementById('g-title').innerText = "MINES";
            box.innerHTML = `<input id="m-bet" class="input" type="number" placeholder="–°—Ç–∞–≤–∫–∞"><button class="btn" onclick="startM()">–ò–ì–†–ê–¢–¨</button><div id="m-grid" style="display:grid; grid-template-columns:repeat(5,1fr); gap:5px; margin-top:10px;"></div>`;
        }
    }

    // JACKPOT (–ù–ï –°–ì–û–†–ê–ï–¢)
    function startW() {
        let b = s(document.getElementById('w-bet').value);
        if(b < 1 || b > db.bal) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON!");
        db.bal -= b; db.jackpot_bet = b; save();
        restoreW();
        setTimeout(() => { if(db.jackpot_bet > 0) runW(); }, 5000);
    }
    function restoreW() {
        document.getElementById('w-pot').innerText = "–ë–∞–Ω–∫: " + (db.jackpot_bet * 2).toFixed(2) + " TON";
        document.getElementById('g-info').innerText = "–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...";
        document.getElementById('w-ui').style.display = 'none';
    }
    function runW() {
        let tr = document.getElementById('w-track'); if(!tr) return;
        tr.style.transform = `translateX(-${Math.floor(Math.random()*1000)+1000}px)`;
        setTimeout(() => {
            let win = db.jackpot_bet * 2;
            alert("–ü–û–ë–ï–î–ê! + " + win.toFixed(2) + " TON");
            db.bal += win; db.jackpot_bet = 0; save();
            closeG(); update();
        }, 4500);
    }

    // –ú–ò–ù–´
    function startM() {
        let b = s(document.getElementById('m-bet').value);
        if(b < 1 || b > db.bal) return alert("–ú–∞–ª–æ TON!");
        db.bal -= b; game = { active: true, bet: b, mult: 1, mines: [] };
        while(game.mines.length < 3) { let r = Math.floor(Math.random()*25); if(!game.mines.includes(r)) game.mines.push(r); }
        let g = document.getElementById('m-grid'); g.innerHTML = '';
        for(let i=0; i<25; i++) {
            let c = document.createElement('div'); c.style = "background:#334155; height:45px; border-radius:8px; display:flex; align-items:center; justify-content:center;";
            c.innerText = "?";
            c.onclick = () => {
                if(!game.active || c.innerText !== "?") return;
                if(game.mines.includes(i)) { c.innerText="üí£"; c.style.background="red"; game.active=false; document.getElementById('cashout-btn').style.display="none"; }
                else { c.innerText="üíé"; c.style.background="green"; game.mult += 0.4; document.getElementById('g-info').innerText="–ö—É—à: "+(game.bet*game.mult).toFixed(2); document.getElementById('cashout-btn').style.display="block"; }
            }; g.appendChild(c);
        }
        update();
    }

    function doCashout() { if(!game.active) return; db.bal += game.bet * game.mult; game.active = false; closeG(); update(); }
    function closeG() { document.getElementById('g-list').style.display = 'block'; document.getElementById('g-play').style.display = 'none'; document.getElementById('g-info').innerText = ''; }

    // –ê–î–ú–ò–ù–ö–ê
    function openAdmin() {
        let pass = prompt("–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥:");
        if(pass === "admin") {
            let add = s(prompt("–°–∫–æ–ª—å–∫–æ –≤—ã–¥–∞—Ç—å TON?"));
            db.bal += add; update(); alert("–í—ã–¥–∞–Ω–æ!");
        }
    }

    function renderQuests() {
        let qb = document.getElementById('q-list'); qb.innerHTML = '';
        const qs = [
            { id: 'q1', t: "100 –∫–ª–∏–∫–æ–≤", v: 100, r: 10, cur: db.clk },
            { id: 'q2', t: "500 –∫–ª–∏–∫–æ–≤", v: 500, r: 50, cur: db.clk }
        ];
        qs.forEach(q => {
            let done = db[q.id];
            qb.innerHTML += `<div style="display:flex; justify-content:space-between; margin:10px 0;">
                <span>${q.t} (${q.cur}/${q.v})</span>
                <button onclick="claim('${q.id}', ${q.cur>=q.v && !done})" class="btn" style="width:auto; padding:5px 10px; background:${done?'#334155':'#10b981'}">${done?'‚úÖ':'–í–ó–Ø–¢–¨'}</button>
            </div>`;
        });
    }
    function claim(id, can) { if(can) { db[id] = true; db.bal += 50; update(); alert("–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞!"); } }

    setInterval(update, 1000);
    update();
</script>

</body>
</html>
