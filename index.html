<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Empire Ultimate</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background: radial-gradient(circle at center, #1e1b4b, #0f172a);
            color: #ffffff; text-align: center; font-family: 'Segoe UI', sans-serif;
            margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh;
        }

        /* UI –≠–õ–ï–ú–ï–ù–¢–´ */
        .top-bar { background: rgba(0,0,0,0.4); padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #334155; }
        .balance { font-size: 22px; font-weight: bold; color: #0098EA; }
        
        .tab-content { flex-grow: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; }
        .active-tab { display: flex; }

        /* –ö–õ–ò–ö–ï–† */
        #coin {
            width: 200px; height: 200px; background: #0098EA; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; margin: 40px 0;
            box-shadow: 0 0 40px rgba(0,152,234,0.5); transition: 0.05s;
        }
        #coin:active { transform: scale(0.95); }

        /* –û–ë–©–ò–ï –°–¢–ò–õ–ò –ò–ì–† */
        .game-container { width: 100%; display: none; flex-direction: column; align-items: center; }
        .game-active { display: flex; }
        .btn { border: none; padding: 12px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; color: white; margin: 5px; }
        .btn-blue { background: #0098EA; }
        .btn-orange { background: #f59e0b; }
        .btn-red { background: #ef4444; }
        .game-input { background: #1e293b; border: 1px solid #475569; color: white; padding: 10px; border-radius: 10px; margin-bottom: 10px; width: 80%; text-align: center; }

        /* –ú–ò–ù–´ */
        .grid-5x5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin: 15px 0; width: 90%; }
        .cell { aspect-ratio: 1; background: #334155; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        /* –õ–ï–°–ï–ù–ö–ê */
        .ladder-grid { display: flex; flex-direction: column-reverse; gap: 5px; width: 80%; }
        .ladder-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .ladder-cell { padding: 15px; background: #334155; border-radius: 10px; }

        /* –ë–õ–≠–ö–î–ñ–ï–ö */
        .bj-area { background: rgba(16, 185, 129, 0.1); border-radius: 15px; padding: 15px; width: 90%; margin: 10px 0; }
        .cards { font-size: 24px; letter-spacing: 5px; margin: 10px 0; }

        /* NAV */
        .bottom-nav { background: #0f172a; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #334155; }
        .nav-item { color: #94a3b8; font-size: 12px; cursor: pointer; }
        .nav-item.active { color: #0098EA; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="balance">üíé <span id="balance">0</span> TON</div>
        <button class="btn btn-blue" onclick="alert('–ü–∏—à–∏ @fresei')">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    </div>

    <div id="tab-clicker" class="tab-content active-tab">
        <div id="coin">üíé</div>
        <div style="color:#34d399; font-weight:bold;">‚ö° –≠–Ω–µ—Ä–≥–∏—è: <span id="energy">1000</span></div>
    </div>

    <div id="tab-games" class="tab-content">
        <div id="games-menu" style="display: flex; flex-direction: column; width: 90%;">
            <button class="btn btn-blue" onclick="showGame('mines')">üí£ –ú–ò–ù–´ (5—Ö5)</button>
            <button class="btn btn-orange" onclick="showGame('ladder')">ü™ú –õ–ï–°–ï–ù–ö–ê</button>
            <button class="btn btn-red" onclick="showGame('bj')">üÉè –ë–õ–≠–ö–î–ñ–ï–ö</button>
        </div>

        <div id="game-mines" class="game-container">
            <h3 id="m-status">–ú–ò–ù–´</h3>
            <input type="number" id="m-bet" class="game-input" placeholder="–°—Ç–∞–≤–∫–∞">
            <button class="btn btn-blue" onclick="startMines()">–ò–ì–†–ê–¢–¨</button>
            <div id="m-grid" class="grid-5x5"></div>
            <button id="m-cashout" class="btn btn-orange" style="display:none" onclick="cashoutMines()">–ó–ê–ë–†–ê–¢–¨</button>
            <button class="btn btn-red" onclick="exitGames()">–í–´–ô–¢–ò</button>
        </div>

        <div id="game-ladder" class="game-container">
            <h3 id="l-status">–õ–ï–°–ï–ù–ö–ê</h3>
            <input type="number" id="l-bet" class="game-input" placeholder="–°—Ç–∞–≤–∫–∞">
            <button class="btn btn-blue" onclick="startLadder()">–ò–ì–†–ê–¢–¨</button>
            <div id="l-grid" class="ladder-grid"></div>
            <button id="l-cashout" class="btn btn-orange" style="display:none" onclick="cashoutLadder()">–ó–ê–ë–†–ê–¢–¨</button>
            <button class="btn btn-red" onclick="exitGames()">–í–´–ô–¢–ò</button>
        </div>

        <div id="game-bj" class="game-container">
            <h3 id="bj-status">–ë–õ–≠–ö–î–ñ–ï–ö</h3>
            <input type="number" id="bj-bet" class="game-input" placeholder="–°—Ç–∞–≤–∫–∞">
            <button id="bj-start-btn" class="btn btn-blue" onclick="startBJ()">–ò–ì–†–ê–¢–¨</button>
            <div class="bj-area">
                <div>–î–∏–ª–µ—Ä: <span id="bj-d-val">?</span></div>
                <div id="bj-d-cards" class="cards">üé¥</div>
                <hr>
                <div>–í—ã: <span id="bj-p-val">0</span></div>
                <div id="bj-p-cards" class="cards"></div>
            </div>
            <div id="bj-ctrl" style="display:none">
                <button class="btn btn-blue" onclick="bjHit()">–ï–©–ï</button>
                <button class="btn btn-orange" onclick="bjStand()">–•–í–ê–¢–ò–¢</button>
            </div>
            <button class="btn btn-red" onclick="exitGames()">–í–´–ô–¢–ò</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('clicker', this)">üíé –§–∞—Ä–º</div>
        <div class="nav-item" onclick="onclick=switchTab('games', this)">üé≤ –ò–≥—Ä—ã</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp; tg.expand();
        let balance = parseInt(localStorage.getItem('bal')) || 0;
        let energy = 1000;
        let currentBet = 0, multiplier = 1, gameActive = false;

        function updateUI() {
            document.getElementById('balance').innerText = Math.floor(balance).toLocaleString();
            document.getElementById('energy').innerText = Math.floor(energy);
            localStorage.setItem('bal', balance);
        }

        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
            document.getElementById('tab-'+id).classList.add('active-tab');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
            exitGames();
        }

        function showGame(id) {
            document.getElementById('games-menu').style.display = 'none';
            document.querySelectorAll('.game-container').forEach(g => g.classList.remove('game-active'));
            document.getElementById('game-'+id).classList.add('game-active');
        }

        function exitGames() {
            document.getElementById('games-menu').style.display = 'flex';
            document.querySelectorAll('.game-container').forEach(g => g.classList.remove('game-active'));
            gameActive = false;
        }

        // --- –õ–û–ì–ò–ö–ê –ú–ò–ù ---
        let minesArr = [];
        function startMines() {
            let b = parseInt(document.getElementById('m-bet').value);
            if(isNaN(b) || b > balance || b <= 0) return alert("–ú–∞–ª–æ TON!");
            balance -= b; currentBet = b; multiplier = 1; gameActive = true;
            minesArr = Array(25).fill(0).map(() => Math.random() < 0.2 ? 1 : 0);
            let grid = document.getElementById('m-grid'); grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let c = document.createElement('div'); c.className = 'cell';
                c.onclick = () => {
                    if(!gameActive || c.innerHTML !== '') return;
                    if(minesArr[i]) { c.innerHTML='üí£'; c.style.bg='#ef4444'; gameActive=false; document.getElementById('m-status').innerText='–ü–†–û–ò–ì–†–´–®!'; }
                    else { c.innerHTML='üíé'; multiplier += 0.4; document.getElementById('m-cashout').style.display='block'; }
                    updateUI();
                };
                grid.appendChild(c);
            }
            updateUI();
        }
        function cashoutMines() { balance += currentBet * multiplier; exitGames(); updateUI(); }

        // --- –õ–û–ì–ò–ö–ê –õ–ï–°–ï–ù–ö–ò ---
        let currentStep = 0;
        function startLadder() {
            let b = parseInt(document.getElementById('l-bet').value);
            if(isNaN(b) || b > balance || b <= 0) return alert("–ú–∞–ª–æ TON!");
            balance -= b; currentBet = b; multiplier = 1; currentStep = 0; gameActive = true;
            let grid = document.getElementById('l-grid'); grid.innerHTML = '';
            for(let i=0; i<5; i++) {
                let row = document.createElement('div'); row.className = 'ladder-row';
                let trap = Math.floor(Math.random()*2);
                row.innerHTML = `<div class="ladder-cell" onclick="stepLadder(0, ${trap}, ${i}, this)">?</div>
                                 <div class="ladder-cell" onclick="stepLadder(1, ${trap}, ${i}, this)">?</div>`;
                grid.appendChild(row);
            }
            updateUI();
        }
        function stepLadder(choice, trap, step, el) {
            if(!gameActive || step !== currentStep) return;
            if(choice === trap) { el.innerHTML='üí•'; gameActive=false; }
            else { el.innerHTML='üíé'; multiplier *= 1.8; currentStep++; document.getElementById('l-cashout').style.display='block'; }
        }
        function cashoutLadder() { balance += currentBet * multiplier; exitGames(); updateUI(); }

        // --- –õ–û–ì–ò–ö–ê –ë–õ–≠–ö–î–ñ–ï–ö–ê ---
        let pScore = 0, dScore = 0;
        function startBJ() {
            let b = parseInt(document.getElementById('bj-bet').value);
            if(isNaN(b) || b > balance || b <= 0) return alert("–ú–∞–ª–æ TON!");
            balance -= b; currentBet = b; gameActive = true;
            pScore = Math.floor(Math.random()*10)+2 + Math.floor(Math.random()*10)+2;
            dScore = Math.floor(Math.random()*10)+2;
            document.getElementById('bj-p-val').innerText = pScore;
            document.getElementById('bj-d-val').innerText = dScore;
            document.getElementById('bj-ctrl').style.display = 'block';
            document.getElementById('bj-start-btn').style.display = 'none';
            updateUI();
        }
        function bjHit() {
            pScore += Math.floor(Math.random()*10)+2;
            document.getElementById('bj-p-val').innerText = pScore;
            if(pScore > 21) { document.getElementById('bj-status').innerText='–ü–ï–†–ï–ë–û–†!'; bjEnd(false); }
        }
        function bjStand() {
            while(dScore < 17) dScore += Math.floor(Math.random()*10)+2;
            document.getElementById('bj-d-val').innerText = dScore;
            if(dScore > 21 || pScore > dScore) bjEnd(true);
            else bjEnd(false);
        }
        function bjEnd(win) {
            gameActive = false;
            if(win) { balance += currentBet * 2; document.getElementById('bj-status').innerText='–ü–û–ë–ï–î–ê!'; }
            else { document.getElementById('bj-status').innerText='–ü–†–û–ò–ì–†–´–®'; }
            setTimeout(exitGames, 2000);
            document.getElementById('bj-ctrl').style.display = 'none';
            document.getElementById('bj-start-btn').style.display = 'block';
            updateUI();
        }

        document.getElementById('coin').onclick = () => { if(energy>0){ balance++; energy--; updateUI(); } };
        setInterval(() => { if(energy<1000) energy+=0.5; updateUI(); }, 1000);
        updateUI();
    </script>
</body>
</html>
