<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Empire Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --accent: #0098EA; --bg: #0b0f1a; --glass: rgba(255, 255, 255, 0.07); --neon: #00f2ff; }
        body {
            background: var(--bg); color: #fff; text-align: center; font-family: 'Inter', sans-serif;
            margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh;
        }
        
        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω */
        .bg-glow { position: fixed; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(0,152,234,0.1) 0%, transparent 40%); z-index: -1; animation: rotate 20s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .top-bar { background: rgba(11, 15, 26, 0.8); backdrop-filter: blur(20px); padding: 15px 20px; display: flex; justify-content: space-between; border-bottom: 1px solid var(--glass); }
        .balance-val { font-size: 24px; font-weight: 900; color: #fff; text-shadow: 0 0 15px var(--accent); }

        .tab-content { flex-grow: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; padding-bottom: 120px; }
        .active-tab { display: flex; }

        /* –ú–û–ù–ï–¢–ê –ò –¢–ê–ô–ú–ï–† */
        #coin { width: 210px; height: 210px; background: linear-gradient(135deg, #0098EA, #00f2ff); border-radius: 50%; margin: 30px auto; display: flex; align-items: center; justify-content: center; font-size: 65px; cursor: pointer; box-shadow: 0 0 40px rgba(0, 152, 234, 0.5); border: 8px solid rgba(255,255,255,0.1); position: relative; }
        .tap-anim { position: absolute; color: #fff; font-weight: bold; font-size: 30px; pointer-events: none; animation: fly 0.6s ease-out forwards; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        @keyframes fly { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-120px); } }
        .timer-text { font-size: 13px; color: #94a3b8; margin-top: 5px; font-style: italic; }

        /* –ò–ì–†–´ (–ú–ï–•–ê–ù–ò–ö–ê –ù–ï –¢–†–û–ù–£–¢–ê) */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 15px 0; }
        .m-cell { width: 55px; height: 55px; background: #1e293b; border-radius: 12px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--glass); transition: 0.2s; }
        .open-gem { background: linear-gradient(135deg, #10b981, #34d399); box-shadow: 0 0 15px rgba(16, 185, 129, 0.4); }
        .open-bomb { background: linear-gradient(135deg, #ef4444, #f87171); box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }
        
        .ladder-grid { display: flex; flex-direction: column-reverse; gap: 8px; width: 260px; }
        .ladder-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .ladder-row.locked { opacity: 0.2; pointer-events: none; }
        .l-cell { background: #1e293b; padding: 18px; border-radius: 15px; font-weight: bold; border: 1px solid var(--glass); }

        /* –ö–ê–†–¢–û–ß–ö–ò –ò –ö–í–ï–°–¢–´ */
        .glass-card { background: var(--glass); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; padding: 18px; width: 100%; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .quest-item { background: rgba(255,255,255,0.03); border-radius: 15px; padding: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 14px; }

        /* –ö–ù–û–ü–ö–ò */
        .btn { border: none; padding: 16px; border-radius: 18px; font-weight: 800; color: #fff; cursor: pointer; transition: 0.3s; width: 100%; letter-spacing: 1px; }
        .btn-blue { background: linear-gradient(90deg, #0098EA, #00c2ff); box-shadow: 0 4px 15px rgba(0, 152, 234, 0.3); }
        .btn-orange { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .input-dark { background: #161b2a; border: 1px solid #2d3748; color: #fff; padding: 14px; border-radius: 14px; width: 90%; margin-bottom: 15px; text-align: center; font-size: 16px; }

        /* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
        .bottom-nav { background: rgba(11, 15, 26, 0.95); backdrop-filter: blur(20px); border-top: 1px solid var(--glass); display: flex; justify-content: space-around; padding: 12px 0 35px 0; position: fixed; bottom: 0; width: 100%; }
        .nav-item { color: #64748b; font-size: 11px; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: var(--accent); transform: translateY(-5px); }
        .nav-item b { font-size: 24px; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>
    <div class="bg-glow"></div>

    <div class="top-bar">
        <div><small style="color: #94a3b8;">–í–ê–® –ë–ê–õ–ê–ù–°</small><div class="balance-val"><span id="balance">0</span> <small style="font-size:12px">TON</small></div></div>
        <div style="text-align: right;"><small style="color: #94a3b8;">–î–û–•–û–î</small><div style="color:#34d399; font-weight:bold;">+<span id="pps">0</span>/s</div></div>
    </div>

    <div id="tab-farm" class="tab-content active-tab">
        <div id="coin">üíé</div>
        <div style="font-size: 32px; font-weight: 900; letter-spacing: 2px;">‚ö° <span id="energy">250</span></div>
        <div id="energy-timer" class="timer-text">–ó–∞—Ä—è–∂–µ–Ω–æ –Ω–∞ 100%</div>
        <div style="width: 70%; background: #1e293b; height: 6px; border-radius: 10px; margin-top:15px;">
            <div id="nrg-bar" style="height:100%; background:var(--accent); width:100%; border-radius:10px; transition: 0.3s;"></div>
        </div>
    </div>

    <div id="tab-mine" class="tab-content">
        <h2 style="margin-bottom:20px;">‚õè Passive Mining</h2>
        <div class="glass-card">
            <div><b>VideoCard V3</b><br><small style="color:#34d399">+0.10/—Å–µ–∫</small></div>
            <button class="btn btn-blue" style="width:110px" onclick="buyM(1, 100, 0.1)">100 T</button>
        </div>
        <div class="glass-card">
            <div><b>Mining Rig</b><br><small style="color:#34d399">+0.50/—Å–µ–∫</small></div>
            <button class="btn btn-blue" style="width:110px" onclick="buyM(2, 450, 0.5)">450 T</button>
        </div>
        <div class="glass-card">
            <div><b>Cloud Cluster</b><br><small style="color:#34d399">+2.00/—Å–µ–∫</small></div>
            <button class="btn btn-blue" style="width:110px" onclick="buyM(3, 1500, 2.0)">1.5k T</button>
        </div>
    </div>

    <div id="tab-games" class="tab-content">
        <div id="g-list" style="width:100%">
            <div class="glass-card" onclick="uiG('mines')"><div><b>üí£ MINES</b><br><small>–°—Ç–∞–≤–∫–∏ –¥–æ 10M</small></div><span>‚ñ∂</span></div>
            <div class="glass-card" onclick="uiG('ladder')"><div><b>ü™ú LADDER</b><br><small>–°—Ç–∞–≤–∫–∏ –¥–æ 10M</small></div><span>‚ñ∂</span></div>
            <div class="glass-card" onclick="uiG('wheel')" style="border-color: #f59e0b;"><div><b>üé° JACKPOT WHEEL</b><br><small>–ò–≥—Ä–∞ —Å –¥—Ä—É–≥–∏–º–∏ –∫–∞–∂–¥—ã–µ 30—Å</small></div><span>üî•</span></div>
        </div>

        <div id="g-play" style="display:none; width:100%">
            <h2 id="g-title" style="letter-spacing:3px">–ò–ì–†–ê</h2>
            <div id="g-area"></div>
            <div id="g-info" style="margin:20px 0; color:#f59e0b; font-weight:bold; font-size:20px;"></div>
            <button id="btn-cashout" class="btn btn-orange" style="display:none; margin-bottom:10px;" onclick="doCashout()">–í–ó–Ø–¢–¨ –ü–†–ò–ó</button>
            <button class="btn" style="background:rgba(255,255,255,0.1)" onclick="closeG()">–ù–ê–ó–ê–î</button>
        </div>
    </div>

    <div id="tab-profile" class="tab-content">
        <div class="glass-card" style="flex-direction:column; gap:15px; padding:25px;">
            <div style="font-size:18px; font-weight:bold;">–ö–í–ï–°–¢–´ (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ 00:00)</div>
            <div id="quests-box" style="width:100%"></div>
            <button class="btn btn-blue" onclick="claimDaily()">üéÅ –ó–ê–ë–†–ê–¢–¨ DAILY –ë–û–ù–£–°</button>
        </div>
        
        <div class="glass-card" style="margin-top:10px; background: linear-gradient(135deg, rgba(0,152,234,0.1), transparent);">
            <div style="text-align:left">
                <b>VIP –°–¢–ê–¢–£–°</b><br>
                <small>x3 –ö–ª–∏–∫–∏ | 10k –≠–Ω–µ—Ä–≥–∏–∏</small>
            </div>
            <button class="btn btn-blue" style="width:100px; padding:10px" onclick="tg.openLink('https://t.me/fresei')">–ö–£–ü–ò–¢–¨</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchT('farm', this)"><b>‚õè</b>–ö–ª–∏–∫</div>
        <div class="nav-item" onclick="switchT('mine', this)"><b>üíª</b>–ú–∞–π–Ω–∏–Ω–≥</div>
        <div class="nav-item" onclick="switchT('games', this)"><b>üé≤</b>–ò–≥—Ä—ã</div>
        <div class="nav-item" onclick="switchT('profile', this)"><b>üë§</b>–ö–≤–µ—Å—Ç—ã</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe?.user?.id || 0;
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è + –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤
        let today = new Date().toLocaleDateString();
        let db = JSON.parse(localStorage.getItem('ton_final_elite')) || {
            bal: 50, nrg: 250, pps: 0, clk: 0, last: Date.now(), 
            vip: false, daily: 0, 
            q_date: today, q_list: [false, false, false, false, false]
        };

        // –°–±—Ä–æ—Å –∫–≤–µ—Å—Ç–æ–≤ –≤ 00:00
        if(db.q_date !== today) {
            db.q_list = [false, false, false, false, false];
            db.q_date = today;
            save();
        }

        let cur = { active: false, bet: 0, mult: 1, type: '', data: null, step: 0 };
        let wheelSec = 30;

        function save() { localStorage.setItem('ton_final_elite', JSON.stringify(db)); }

        function update() {
            let now = Date.now();
            let dt = (now - db.last) / 1000;
            db.bal += db.pps * dt;
            let maxN = db.vip ? 10000 : 250;
            let reg = db.vip ? 1.0 : 0.25;
            
            if(db.nrg < maxN) {
                db.nrg = Math.min(maxN, db.nrg + (dt * reg));
                let remain = (maxN - db.nrg) / reg;
                let m = Math.floor(remain / 60);
                let s = Math.floor(remain % 60);
                document.getElementById('energy-timer').innerText = `–§—É–ª–ª —ç–Ω–µ—Ä–≥–∏—è —á–µ—Ä–µ–∑: ${m}:${s < 10 ? '0'+s : s}`;
            } else {
                document.getElementById('energy-timer').innerText = "–ó–∞—Ä—è–∂–µ–Ω–æ –Ω–∞ 100%";
            }

            db.last = now;
            document.getElementById('balance').innerText = db.bal.toLocaleString(undefined, {minimumFractionDigits: 2});
            document.getElementById('pps').innerText = db.pps.toFixed(2);
            document.getElementById('energy').innerText = Math.floor(db.nrg);
            document.getElementById('nrg-bar').style.width = (db.nrg/maxN*100)+'%';
            
            renderQuests();
            save();
        }

        // –ö–í–ï–°–¢–´
        const QUEST_DATA = [
            { t: "–ö–ª–∏–∫–Ω—É—Ç—å 500 —Ä–∞–∑", r: 10, v: 500 },
            { t: "–ö–ª–∏–∫–Ω—É—Ç—å 2000 —Ä–∞–∑", r: 50, v: 2000 },
            { t: "–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 1000 TON", r: 100, v: 1000 },
            { t: "–ö—É–ø–∏—Ç—å 1 —Ñ–µ—Ä–º—É", r: 20, v: 0.01 },
            { t: "–°—Ç–∞—Ç—å VIP", r: 500, v: 1 }
        ];

        function renderQuests() {
            let box = document.getElementById('quests-box');
            box.innerHTML = '';
            QUEST_DATA.forEach((q, i) => {
                let done = db.q_list[i];
                let progress = i < 2 ? db.clk : (i === 2 ? db.bal : (i === 3 ? db.pps : (db.vip ? 1 : 0)));
                let canClaim = !done && progress >= q.v;
                
                box.innerHTML += `
                    <div class="quest-item">
                        <div><b>${q.t}</b><br><small>–ù–∞–≥—Ä–∞–¥–∞: ${q.r} TON</small></div>
                        <button class="btn" style="width:80px; padding:8px; background:${done?'#334155':(canClaim?'#10b981':'#1e293b')}" 
                        onclick="claimQ(${i}, ${canClaim})">${done?'‚úÖ':(canClaim?'–í–ó–Ø–¢–¨':'...')}</button>
                    </div>
                `;
            });
        }
        function claimQ(i, can) {
            if(!can) return;
            db.q_list[i] = true;
            db.bal += QUEST_DATA[i].r;
            alert("–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞!");
            update();
        }

        // –ö–õ–ò–ö–ï–†
        document.getElementById('coin').onclick = (e) => {
            if(db.nrg >= 1) {
                db.nrg--; db.clk++;
                let add = db.vip ? 1.5 : 0.5;
                db.bal += add;
                let a = document.createElement('div');
                a.className = 'tap-anim'; a.innerText = `+${add}`;
                a.style.left = e.clientX + 'px'; a.style.top = e.clientY + 'px';
                document.body.appendChild(a);
                setTimeout(() => a.remove(), 600);
                update();
                if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
            }
        };

        // –ò–ì–†–´
        function uiG(t) {
            document.getElementById('g-list').style.display = 'none';
            document.getElementById('g-play').style.display = 'block';
            cur.type = t;
            let area = document.getElementById('g-area');
            if(t === 'mines') {
                document.getElementById('g-title').innerText = "üí£ MINES";
                area.innerHTML = `
                    <input type="number" id="mb" class="input-dark" placeholder="–°—Ç–∞–≤–∫–∞ (max 10M)">
                    <select id="mc" class="input-dark"><option value="3">3 –ú–ò–ù–´</option><option value="5">5 –ú–ò–ù</option><option value="10">10 –ú–ò–ù</option></select>
                    <button class="btn btn-blue" onclick="startM()">–ò–ì–†–ê–¢–¨</button>
                    <div id="m-grid" class="mines-grid"></div>
                `;
            } else if(t === 'ladder') {
                document.getElementById('g-title').innerText = "ü™ú LADDER";
                area.innerHTML = `<input type="number" id="lb" class="input-dark" placeholder="–°—Ç–∞–≤–∫–∞ (max 10M)"><button class="btn btn-blue" onclick="startL()">–ù–ê–ß–ê–¢–¨</button><div id="l-grid" class="ladder-grid"></div>`;
            } else if(t === 'wheel') {
                document.getElementById('g-title').innerText = "üé° JACKPOT";
                area.innerHTML = `
                    <div style="background:rgba(255,255,255,0.05); padding:20px; border-radius:20px; border: 1px dashed var(--accent);">
                        <div id="w-timer" style="font-size:30px; font-weight:900; color:var(--accent)">00:30</div>
                        <div id="w-pot" style="margin:10px; font-size:18px;">–û–±—â–∏–π –±–∞–Ω–∫: 0.00 TON</div>
                        <div id="w-players" style="font-size:12px; color:#94a3b8; margin-bottom:15px;">–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...</div>
                        <input type="number" id="wb" class="input-dark" placeholder="–í–∞—à–∞ —Å—Ç–∞–≤–∫–∞ (1 - 1M)">
                        <button class="btn btn-blue" onclick="betWheel()">–°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£</button>
                    </div>
                `;
                startWheelTick();
            }
        }

        // –†–£–õ–ï–¢–ö–ê –õ–û–ì–ò–ö–ê
        let pot = 0;
        function startWheelTick() {
            let tick = setInterval(() => {
                if(cur.type !== 'wheel') { clearInterval(tick); return; }
                wheelSec--;
                document.getElementById('w-timer').innerText = `00:${wheelSec < 10 ? '0'+wheelSec : wheelSec}`;
                if(wheelSec <= 0) {
                    wheelSec = 30;
                    if(pot > 0) {
                        alert("üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ –î–∂–µ–∫–ø–æ—Ç: " + (pot * 1.9).toFixed(2) + " TON!");
                        db.bal += pot * 1.9; pot = 0;
                        document.getElementById('w-pot').innerText = `–û–±—â–∏–π –±–∞–Ω–∫: 0.00 TON`;
                        update();
                    }
                }
            }, 1000);
        }
        function betWheel() {
            let b = parseFloat(document.getElementById('wb').value);
            if(b > db.bal || b < 1 || b > 1000000) return alert("–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞!");
            db.bal -= b; pot += b;
            document.getElementById('w-pot').innerText = `–û–±—â–∏–π –±–∞–Ω–∫: ${pot.toFixed(2)} TON`;
            document.getElementById('w-players').innerText = "–í—ã –∏ 3 –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–∞ –≤ –∏–≥—Ä–µ";
            update();
        }

        // –ú–ò–ù–´ –ò –õ–ï–°–ï–ù–ö–ê (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô –í –õ–û–ì–ò–ö–ï)
        function startM() {
            let b = parseFloat(document.getElementById('mb').value); let c = parseInt(document.getElementById('mc').value);
            if(b > db.bal || b < 1 || b > 10000000) return alert("–û—à–∏–±–∫–∞ —Å—Ç–∞–≤–∫–∏!");
            db.bal -= b; cur = { active: true, bet: b, mult: 1, type: 'mines', data: Array(25).fill(false) };
            let p=0; while(p<c){let r=Math.floor(Math.random()*25); if(!cur.data[r]){cur.data[r]=true; p++;}}
            let grid = document.getElementById('m-grid'); grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let d = document.createElement('div'); d.className = 'm-cell'; d.innerText = '?';
                d.onclick = () => {
                    if(!cur.active || d.innerText !== '?') return;
                    if(cur.data[i]) { d.innerText = 'üí£'; d.classList.add('open-bomb'); cur.active = false; document.getElementById('btn-cashout').style.display = 'none'; }
                    else { d.innerText = 'üíé'; d.classList.add('open-gem'); cur.mult += (c/4)+0.3; document.getElementById('g-info').innerText = `–ö—É—à: ${(cur.bet*cur.mult).toFixed(2)} TON`; document.getElementById('btn-cashout').style.display = 'block'; }
                }; grid.appendChild(d);
            }
            update();
        }

        function startL() {
            let b = parseFloat(document.getElementById('lb').value);
            if(b > db.bal || b < 1 || b > 10000000) return alert("–û—à–∏–±–∫–∞ —Å—Ç–∞–≤–∫–∏!");
            db.bal -= b; cur = { active: true, bet: b, mult: 1, type: 'ladder', step: 0 };
            let grid = document.getElementById('l-grid'); grid.innerHTML = '';
            for(let i=0; i<6; i++) {
                let r = document.createElement('div'); r.className = 'ladder-row' + (i>0?' locked':'');
                let t = Math.floor(Math.random()*2);
                r.innerHTML = `<div class="l-cell" onclick="stepL(0,${t},${i},this)">?</div><div class="l-cell" onclick="stepL(1,${t},${i},this)">?</div>`;
                grid.appendChild(r);
            }
            update();
        }
        function stepL(ch, tr, idx, el) {
            if(!cur.active || idx !== cur.step) return;
            if(ch === tr) { el.innerText = 'üí•'; el.style.background = '#ef4444'; cur.active = false; document.getElementById('btn-cashout').style.display = 'none'; }
            else { el.innerText = 'üíé'; el.style.background = '#10b981'; cur.mult *= 2.1; cur.step++; document.getElementById('btn-cashout').style.display = 'block'; if(cur.step < 6) document.querySelectorAll('.ladder-row')[cur.step].classList.remove('locked'); }
        }

        function doCashout() { if(!cur.active) return; db.bal += cur.bet * cur.mult; cur.active = false; closeG(); update(); }
        function closeG() { document.getElementById('g-list').style.display = 'block'; document.getElementById('g-play').style.display = 'none'; document.getElementById('g-info').innerText = ''; cur.active = false; wheelSec = 30; }
        function buyM(id, cost, p) { if(db.bal >= cost){ db.bal -= cost; db.pps += p; update(); alert("–£—Å–ø–µ—à–Ω–æ!"); } }
        function claimDaily() { if(Date.now() - db.daily > 86400000){ db.bal += 15; db.daily = Date.now(); alert("–ë–æ–Ω—É—Å 15 TON –ø–æ–ª—É—á–µ–Ω!"); } else alert("–ü—Ä–∏—Ö–æ–¥–∏ –∑–∞–≤—Ç—Ä–∞!"); }
        function switchT(id, el) { document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab')); document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); document.getElementById('tab-' + id).classList.add('active-tab'); el.classList.add('active'); closeG(); }

        setInterval(update, 1000);
        update();
    </script>
</body>
</html>
