<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Empire Ultimate</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –í–û–ó–í–†–ê–©–ê–ï–ú –ò–ú–ë–û–í–´–ô –ò–ù–¢–ï–†–§–ï–ô–° */
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            color: #ffffff; text-align: center; font-family: 'Segoe UI', Roboto, sans-serif;
            margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh;
        }

        .top-bar {
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px);
            padding: 15px 20px; display: flex; justify-content: space-between;
            align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .balance-amount { font-size: 24px; font-weight: bold; color: #0098EA; display: flex; align-items: center; gap: 5px; }
        
        .tab-content { flex-grow: 1; display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; }
        .active-tab { display: flex; }

        /* –ö–õ–ò–ö–ï–† –¢–û–ù */
        #coin {
            width: 220px; height: 220px; background: radial-gradient(circle at 30% 30%, #38bdf8, #0098EA);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 50px rgba(0, 152, 234, 0.5); transition: transform 0.05s; margin-bottom: 20px;
        }
        #coin:active { transform: scale(0.92); }
        .ton-logo { width: 100px; fill: white; }

        /* –ú–ò–ù–´ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï */
        .mines-grid { 
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; 
            background: rgba(0,0,0,0.3); padding: 10px; border-radius: 15px; margin: 15px 0;
        }
        .cell {
            width: 50px; height: 50px; background: #334155; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; font-size: 20px; cursor: pointer;
        }
        .cell.open-gem { background: #10b981; }
        .cell.open-bomb { background: #ef4444; }

        /* –ö–ù–û–ü–ö–ò */
        .btn { border: none; padding: 12px 25px; border-radius: 12px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; }
        .btn-blue { background: #0098EA; }
        .btn-orange { background: #f59e0b; margin-top: 10px; }
        .btn-red { background: #ef4444; margin-top: 10px; }
        
        .game-input { background: #0f172a; border: 1px solid #475569; color: white; padding: 10px; border-radius: 10px; text-align: center; margin-bottom: 10px; width: 70%; }

        /* –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ */
        .bottom-nav { background: rgba(15, 23, 42, 0.95); border-top: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-around; padding: 15px 0; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 12px; gap: 5px; }
        .nav-item.active { color: #0098EA; }

        /* –ú–û–î–ê–õ–ö–ê @fresei */
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:100; align-items:center; justify-content:center; }
        .modal-content { background:#1e293b; padding:30px; border-radius:20px; width:80%; border: 1px solid #0098EA; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div style="text-align: left;">
            <div style="font-size: 10px; color: #94a3b8;">–ë–ê–õ–ê–ù–°</div>
            <div class="balance-amount">üíé <span id="balance">0</span> TON</div>
        </div>
        <button class="btn btn-blue" style="padding: 8px 15px;" onclick="openModal()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    </div>

    <div id="tab-clicker" class="tab-content active-tab">
        <div id="level-text" style="color:#a78bfa; margin-bottom: 10px;">–£—Ä–æ–≤–µ–Ω—å: 1</div>
        <div id="coin">
            <svg class="ton-logo" viewBox="0 0 24 24"><path d="M12 2L2 12l10 10 10-10L12 2zm0 4.5l5.5 5.5-5.5 5.5-5.5-5.5L12 6.5z"/></svg>
        </div>
        <div style="color: #34d399; font-weight: bold;">‚ö° –≠–Ω–µ—Ä–≥–∏—è: <span id="energy">1000/1000</span></div>
    </div>

    <div id="tab-games" class="tab-content">
        <div id="mines-setup">
            <h2 style="margin-bottom: 5px;">üí£ –ú–ò–ù–´</h2>
            <p style="color: #94a3b8; font-size: 14px; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏ —Å—Ç–∞–≤–∫—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω</p>
            <input type="number" id="m-bet" class="game-input" placeholder="–°—Ç–∞–≤–∫–∞ TON">
            <select id="m-count" class="game-input">
                <option value="3">3 –ú–∏–Ω—ã</option>
                <option value="5">5 –ú–∏–Ω</option>
                <option value="10">10 –ú–∏–Ω</option>
            </select>
            <button class="btn btn-blue" style="width: 75%;" onclick="startMines()">–ò–ì–†–ê–¢–¨</button>
        </div>

        <div id="mines-game" style="display: none; flex-direction: column; align-items: center;">
            <div id="m-status" style="font-weight: bold; margin-bottom: 10px;">–ù–∞–π–¥–∏ –∞–ª–º–∞–∑—ã!</div>
            <div id="m-grid" class="mines-grid"></div>
            <div id="m-multiplier" style="color: #f59e0b; font-weight: bold; margin-bottom: 10px;"></div>
            <button id="m-cashout" class="btn btn-orange" onclick="cashoutMines()">–ó–ê–ë–†–ê–¢–¨ –í–´–ò–ì–†–´–®</button>
        </div>
    </div>

    <div id="tab-shop" class="tab-content">
        <h2>–ú–∞–≥–∞–∑–∏–Ω —ç–Ω–µ—Ä–≥–∏–∏</h2>
        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; width: 80%;">
            <p>üîã +10 000 –≠–Ω–µ—Ä–≥–∏–∏</p>
            <button class="btn btn-blue" onclick="openModal()">–ö—É–ø–∏—Ç—å</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('clicker', this)"><span>üíé</span><span>–§–∞—Ä–º</span></div>
        <div class="nav-item" onclick="switchTab('games', this)"><span>üé≤</span><span>–ò–≥—Ä—ã</span></div>
        <div class="nav-item" onclick="switchTab('shop', this)"><span>üõí</span><span>–ú–∞–≥–∞–∑–∏–Ω</span></div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h3>–ü–æ–∫—É–ø–∫–∞</h3>
            <p>–î–ª—è –æ–ø–ª–∞—Ç—ã –Ω–∞–ø–∏—à–∏—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É:</p>
            <h2 style="color: #0098EA;">@fresei</h2>
            <button class="btn btn-red" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp; tg.expand();
        let balance = parseInt(localStorage.getItem('bal')) || 0;
        let clicks = parseInt(localStorage.getItem('clk')) || 0;
        let energy = 1000;
        let m_active = false, m_bet = 0, m_mult = 1, mines = [];

        function updateUI() {
            document.getElementById('balance').innerText = Math.floor(balance).toLocaleString();
            document.getElementById('energy').innerText = `${Math.floor(energy)}/1000`;
            let lvl = Math.floor(clicks / 15000) + 1;
            document.getElementById('level-text').innerText = `–£—Ä–æ–≤–µ–Ω—å: ${lvl}`;
            localStorage.setItem('bal', balance);
            localStorage.setItem('clk', clicks);
        }

        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + id).classList.add('active-tab');
            el.classList.add('active');
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–≥—Ä—É –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
            document.getElementById('mines-setup').style.display = 'block';
            document.getElementById('mines-game').style.display = 'none';
        }

        // –ö–õ–ò–ö–ï–†
        document.getElementById('coin').onclick = () => {
            if(energy >= 1) {
                energy--; clicks++;
                balance += (Math.floor(clicks/15000) >= 99) ? 1000000 : 1;
                updateUI();
                if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
            }
        };

        // –ú–ò–ù–´
        function startMines() {
            let b = parseInt(document.getElementById('m-bet').value);
            if(isNaN(b) || b > balance || b <= 0) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON!");
            
            balance -= b; m_bet = b; m_mult = 1; m_active = true;
            let count = parseInt(document.getElementById('m-count').value);
            mines = Array(25).fill(false);
            let p = 0; while(p < count) { let r = Math.floor(Math.random()*25); if(!mines[r]) { mines[r]=true; p++; } }

            document.getElementById('mines-setup').style.display = 'none';
            document.getElementById('mines-game').style.display = 'flex';
            document.getElementById('m-cashout').style.display = 'none';
            document.getElementById('m-status').innerText = "–ù–∞–π–¥–∏ –∞–ª–º–∞–∑—ã!";
            
            let grid = document.getElementById('m-grid'); grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let c = document.createElement('div'); c.className = 'cell';
                c.onclick = () => {
                    if(!m_active || c.classList.contains('open-gem')) return;
                    if(mines[i]) {
                        c.classList.add('open-bomb'); c.innerText = 'üí£'; m_active = false;
                        document.getElementById('m-status').innerText = "–ë–ê–ë–ê–•! –ü—Ä–æ–∏–≥—Ä—ã—à";
                        setTimeout(() => switchTab('games', document.querySelectorAll('.nav-item')[1]), 2000);
                    } else {
                        c.classList.add('open-gem'); c.innerText = 'üíé';
                        m_mult += (count/10) + 0.2;
                        document.getElementById('m-multiplier').innerText = `–í—ã–ø–ª–∞—Ç–∞: ${(m_bet * m_mult).toFixed(2)} TON`;
                        document.getElementById('m-cashout').style.display = 'block';
                    }
                };
                grid.appendChild(c);
            }
            updateUI();
        }

        function cashoutMines() {
            if(!m_active) return;
            balance += m_bet * m_mult; m_active = false;
            document.getElementById('m-status').innerText = "–í–´–ò–ì–†–´–® –ó–ê–ë–†–ê–ù!";
            setTimeout(() => switchTab('games', document.querySelectorAll('.nav-item')[1]), 1500);
            updateUI();
        }

        function openModal() { document.getElementById('modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('modal').style.display = 'none'; }

        setInterval(() => { if(energy < 1000) energy += 0.5; updateUI(); }, 1000);
        updateUI();
    </script>
</body>
</html>
