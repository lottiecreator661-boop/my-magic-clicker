<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON EMPIRE v2.0</title>
    <style>
        :root { --accent: #0098EA; --bg: #05080f; --glass: rgba(255, 255, 255, 0.05); --grad: linear-gradient(135deg, #0098EA, #00f2ff); }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; overflow: hidden; height: 100vh; user-select: none; }
        
        .header { padding: 15px 20px; background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); border-bottom: 1px solid var(--glass); display: flex; justify-content: space-between; align-items: center; }
        .balance { font-size: 28px; font-weight: 900; color: #fff; text-shadow: 0 0 20px var(--accent); }
        .online { color: #10b981; font-size: 11px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }

        .tab-content { display: none; padding: 20px; height: calc(100vh - 160px); overflow-y: auto; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* –ö–õ–ò–ö–ï–† */
        #coin-inner { width: 220px; height: 220px; background: var(--grad); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 80px; cursor: pointer; box-shadow: 0 0 50px rgba(0, 152, 234, 0.4); border: 8px solid rgba(255,255,255,0.1); position: relative; z-index: 2; transition: transform 0.05s; }
        #coin-inner:active { transform: scale(0.92); }
        
        .energy-wrap { width: 80%; margin-top: 25px; text-align: center; }
        .energy-bar { width: 100%; height: 12px; background: #1e293b; border-radius: 10px; margin: 8px 0; overflow: hidden; border: 1px solid var(--glass); }
        #energy-fill { width: 100%; height: 100%; background: var(--grad); transition: width 0.3s; }
        .tap-anim { position: absolute; color: #fff; font-weight: 900; font-size: 32px; pointer-events: none; z-index: 10; animation: floatUp 0.7s ease-out forwards; text-shadow: 0 0 10px var(--accent); }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-150px); } }

        /* –ö–ê–†–¢–û–ß–ö–ò –ò –ö–ù–û–ü–ö–ò */
        .card { background: var(--glass); border-radius: 20px; padding: 18px; width: 100%; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.08); box-sizing: border-box; }
        .btn { background: var(--grad); border: none; color: #fff; padding: 16px; border-radius: 15px; font-weight: bold; width: 100%; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .btn:active { transform: scale(0.98); }
        .input { background: #0f172a; border: 1px solid #334155; color: #fff; padding: 14px; border-radius: 12px; width: 100%; box-sizing: border-box; margin-bottom: 10px; text-align: center; }

        /* –ú–ê–ì–ê–ó–ò–ù */
        .vip-card { border: 2px solid #ffd700 !important; background: linear-gradient(to bottom, rgba(255,215,0,0.1), transparent) !important; }
        .vip-tag { background: #ffd700; color: #000; padding: 3px 10px; border-radius: 8px; font-weight: 900; font-size: 12px; }

        .menu { position: fixed; bottom: 0; width: 100%; display: flex; background: rgba(11, 15, 26, 0.98); padding: 10px 0 35px 0; border-top: 1px solid var(--glass); }
        .menu-item { flex: 1; text-align: center; font-size: 11px; color: #64748b; cursor: pointer; transition: 0.3s; }
        .menu-item.active-nav { color: var(--accent); transform: translateY(-3px); }
        .menu-item b { font-size: 20px; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

<div class="header">
    <div>
        <div class="online">‚óè –í –°–ï–¢–ò: <span id="onl-cnt">0</span></div>
        <div class="balance"><span id="bal">0.00</span> <small style="font-size:14px; opacity:0.7">TON</small></div>
    </div>
    <div id="vip-status-top"></div>
</div>

<div id="farm" class="tab-content active">
    <div style="position: relative;">
        <div id="coin-inner">üíé</div>
    </div>
    <div class="energy-wrap">
        <div style="display:flex; justify-content: space-between; font-size: 14px; font-weight: bold;">
            <span>‚ö° –≠–ù–ï–†–ì–ò–Ø</span>
            <span id="nrg-text">2500 / 2500</span>
        </div>
        <div class="energy-bar"><div id="energy-fill"></div></div>
        <div id="nrg-timer" style="font-size: 11px; color: #94a3b8;">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: +1/—Å–µ–∫</div>
    </div>
</div>

<div id="shop" class="tab-content">
    <div class="card vip-card">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2 style="margin:0">ELITE VIP</h2>
            <span class="vip-tag">MAX</span>
        </div>
        <ul style="text-align:left; font-size:14px; padding-left:20px; color:#cbd5e1">
            <li>üíé –ö–ª–∏–∫ –ø—Ä–∏–Ω–æ—Å–∏—Ç <b>1.00 TON</b></li>
            <li>‚ö° –õ–∏–º–∏—Ç —ç–Ω–µ—Ä–≥–∏–∏ <b>2500</b></li>
            <li>üöÄ –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏ x2</li>
            <li>üèÜ –û—Å–æ–±—ã–π —Å—Ç–∞—Ç—É—Å –≤ –ø—Ä–æ—Ñ–∏–ª–µ</li>
        </ul>
        <button class="btn" style="background:#ffd700; color:#000;" onclick="window.location.href='https://t.me/fresei'">–ö–£–ü–ò–¢–¨ –£ @FRESEI</button>
    </div>
</div>

<div id="profile" class="tab-content">
    <div class="card">
        <h3>–ü–†–û–ú–û–ö–û–î</h3>
        <input id="promo-input" class="input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥...">
        <button class="btn" onclick="usePromo()">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
    </div>
    <div class="card">
        <h3>–†–ï–§–ï–†–ê–õ–´</h3>
        <p style="font-size:12px; color:#94a3b8">–ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞: 50 TON</p>
        <button class="btn" style="background:#1e293b" onclick="copyRef()">–ö–û–ü–ò–†–û–í–ê–¢–¨ –°–°–´–õ–ö–£</button>
    </div>
    <button class="btn" id="adm-btn" style="display:none; background:#ef4444; margin-top:10px" onclick="tab('admin')">‚öô –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨</button>
</div>

<div id="admin" class="tab-content">
    <div class="card" style="border-color:#ef4444">
        <h3>–£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ö–û–ú</h3>
        <input id="adm-id" class="input" type="number" placeholder="ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        <input id="adm-val" class="input" type="number" placeholder="–°—É–º–º–∞ / TON">
        <div style="display:flex; gap:10px">
            <button class="btn" style="background:#ef4444" onclick="adminAction('money')">–í–´–î–ê–¢–¨ TON</button>
            <button class="btn" style="background:#f59e0b" onclick="adminAction('vip')">–í–´–î–ê–¢–¨ VIP</button>
        </div>
    </div>
    <div class="card" style="border-color:#ef4444">
        <h3>–ü–†–û–ú–û–ö–û–î–´</h3>
        <input id="prom-name" class="input" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ">
        <input id="prom-val" class="input" type="number" placeholder="–ù–∞–≥—Ä–∞–¥–∞">
        <select id="prom-type" class="input"><option value="ton">TON</option><option value="vip">VIP —Å—Ç–∞—Ç—É—Å</option></select>
        <button class="btn" onclick="createPromo()">–°–û–ó–î–ê–¢–¨ –ü–†–û–ú–û</button>
    </div>
    <button class="btn" style="background:#475569" onclick="tab('profile')">–ù–ê–ó–ê–î</button>
</div>

<div class="menu">
    <div class="menu-item active-nav" onclick="tab('farm', this)"><b>‚õè</b>–§–∞—Ä–º</div>
    <div class="menu-item" onclick="tab('shop', this)"><b>üõí</b>–ú–∞–≥–∞–∑–∏–Ω</div>
    <div class="menu-item" onclick="tab('profile', this)"><b>üë§</b>–ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    const MY_ID = tg.initDataUnsafe?.user?.id || 0;
    const ADMIN_LIST = [8388334620]; 

    function s(v, f=0) { let r = parseFloat(v); return isNaN(r) ? f : r; }

    let db = JSON.parse(localStorage.getItem('ton_v2_save')) || {
        bal: 100, nrg: 2500, clk: 0, last: Date.now(),
        vip: false, promos: {}, usedPromos: []
    };

    function save() { localStorage.setItem('ton_v2_save', JSON.stringify(db)); }

    function update() {
        let now = Date.now();
        let dt = (now - db.last) / 1000;
        
        let maxN = db.vip ? 2500 : 2500; // –ü–æ—Å—Ç–∞–≤–∏–ª 2500 –≤—Å–µ–º, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª
        let regSpeed = db.vip ? 2 : 1; 

        if(db.nrg < maxN) db.nrg = Math.min(maxN, db.nrg + (dt * regSpeed));
        
        db.last = now;
        document.getElementById('bal').innerText = s(db.bal).toFixed(2);
        document.getElementById('nrg-text').innerText = `${Math.floor(s(db.nrg))} / ${maxN}`;
        document.getElementById('energy-fill').style.width = (db.nrg / maxN * 100) + '%';
        document.getElementById('onl-cnt').innerText = Math.floor(Math.random()*20)+1140;
        
        if(db.vip) {
            document.getElementById('vip-status-top').innerHTML = '<span class="vip-tag">VIP</span>';
        }
        if(ADMIN_LIST.includes(MY_ID)) document.getElementById('adm-btn').style.display = 'block';

        save();
    }

    // –ö–õ–ò–ö–ï–† –° –ê–ù–ò–ú–ê–¶–ò–ï–ô
    document.getElementById('coin-inner').addEventListener('click', function(e) {
        if(db.nrg >= 1) {
            let gain = db.vip ? 1.0 : 0.5;
            db.nrg--; db.bal += gain;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            let anim = document.createElement('div');
            anim.className = 'tap-anim';
            anim.innerText = '+' + gain;
            anim.style.left = e.pageX + 'px';
            anim.style.top = e.pageY + 'px';
            document.body.appendChild(anim);
            setTimeout(() => anim.remove(), 700);
            
            update();
        }
    });

    function tab(id, el) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active-nav'));
        document.getElementById(id).classList.add('active');
        if(el) el.classList.add('active-nav');
    }

    // –ü–†–û–ú–û–ö–û–î–´
    function usePromo() {
        let code = document.getElementById('promo-input').value;
        if(db.usedPromos.includes(code)) return alert("–£–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!");
        if(db.promos[code]) {
            let p = db.promos[code];
            if(p.type === 'ton') db.bal += p.val;
            else db.vip = true;
            db.usedPromos.push(code);
            alert("–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!");
            save(); update();
        } else { alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥"); }
    }

    // –ê–î–ú–ò–ù–ö–ê
    function adminAction(type) {
        let id = document.getElementById('adm-id').value;
        let val = s(document.getElementById('adm-val').value);
        if(type === 'money') {
            if(id == MY_ID) db.bal += val;
            alert("–í—ã–¥–∞–Ω–æ " + val + " TON –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é " + id);
        } else {
            if(id == MY_ID) db.vip = true;
            alert("VIP –≤—ã–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é " + id);
        }
        save(); update();
    }

    function createPromo() {
        let name = document.getElementById('prom-name').value;
        let val = s(document.getElementById('prom-val').value);
        let type = document.getElementById('prom-type').value;
        db.promos[name] = { val: val, type: type };
        alert("–ü—Ä–æ–º–æ–∫–æ–¥ " + name + " —Å–æ–∑–¥–∞–Ω!");
        save();
    }

    function copyRef() {
        navigator.clipboard.writeText("https://t.me/your_bot?start=" + MY_ID);
        alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
    }

    setInterval(update, 1000);
    update();
</script>

</body>
</html>
