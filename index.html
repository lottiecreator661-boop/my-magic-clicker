<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TON Empire Pro Max</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --accent: #0098EA; --glass: rgba(255, 255, 255, 0.1); --bg: #0f172a; }
        body {
            background: radial-gradient(circle at top, #1e1b4b, var(--bg));
            color: #fff; text-align: center; font-family: 'Segoe UI', sans-serif;
            margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh;
        }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –®–ê–ü–ö–ò */
        .top-bar {
            background: rgba(0,0,0,0.3); backdrop-filter: blur(15px);
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--glass);
        }
        .balance-val { font-size: 24px; font-weight: bold; color: var(--accent); }

        .tab-content { flex-grow: 1; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; width: 100%; box-sizing: border-box; }
        .active-tab { display: flex; }

        /* –ö–õ–ò–ö–ï–† */
        #coin {
            width: 220px; height: 220px; background: radial-gradient(circle, #38bdf8, #0098EA);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 50px rgba(0,152,234,0.4); transition: 0.05s; margin: 30px 0;
            border: 6px solid rgba(255,255,255,0.1); cursor: pointer;
        }
        #coin:active { transform: scale(0.92); }

        /* –ö–ê–†–¢–û–ß–ö–ò –ò–ì–† (–°–¢–ï–ö–õ–û) */
        .game-shelf { width: 100%; display: flex; flex-direction: column; gap: 15px; }
        .glass-card {
            background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass);
            backdrop-filter: blur(10px); border-radius: 20px; padding: 20px;
            display: flex; justify-content: space-between; align-items: center; text-align: left;
        }

        /* –ú–ò–ù–´ –ì–†–ò–î */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 15px 0; }
        .m-cell { width: 50px; height: 50px; background: #334155; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; }

        /* –õ–ï–°–ï–ù–ö–ê */
        .ladder-grid { display: flex; flex-direction: column-reverse; gap: 10px; width: 250px; }
        .ladder-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; transition: 0.3s; }
        .ladder-row.locked { opacity: 0.2; pointer-events: none; }
        .l-cell { background: #334155; padding: 15px; border-radius: 12px; text-align: center; font-weight: bold; border: 2px solid var(--glass); }

        /* –ü–†–û–§–ò–õ–¨ */
        .prof-box { background: var(--glass); padding: 20px; border-radius: 24px; width: 90%; margin-bottom: 20px; border: 1px solid var(--glass); }

        /* –ö–ù–û–ü–ö–ò –ò –í–í–û–î */
        .input-dark { background: #0f172a; border: 1px solid #334155; color: #fff; padding: 12px; border-radius: 12px; width: 85%; text-align: center; margin-bottom: 10px; font-weight: bold; }
        .btn { border: none; padding: 14px; border-radius: 14px; font-weight: bold; color: #fff; width: 100%; cursor: pointer; transition: 0.2s; }
        .btn-blue { background: var(--accent); }
        .btn-orange { background: #f59e0b; margin-top: 10px; }
        .btn-red { background: #ef4444; margin-top: 10px; }

        /* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
        .bottom-nav { 
            background: #0f172a; border-top: 1px solid var(--glass);
            display: flex; justify-content: space-around; padding: 10px 0 30px 0;
        }
        .nav-item { color: #94a3b8; font-size: 12px; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--accent); }
        .nav-item b { font-size: 22px; display: block; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div style="text-align: left;">
            <div style="font-size: 10px; color: #94a3b8;">–ë–ê–õ–ê–ù–°</div>
            <div class="balance-val">üíé <span id="balance">0</span></div>
        </div>
        <button class="btn btn-blue" style="width: auto; padding: 6px 15px;" onclick="tg.openTelegramLink('https://t.me/fresei')">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    </div>

    <div id="tab-farm" class="tab-content active-tab">
        <div style="width: 85%; display: flex; justify-content: space-between; font-size: 12px; color: #a78bfa; margin-bottom: 5px;">
            <span id="lvl-text">–£—Ä–æ–≤–µ–Ω—å 1</span>
            <span id="lvl-remain">–¥–æ –∞–ø–ø–∞: 15,000</span>
        </div>
        <div style="width: 85%; background: var(--glass); height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 20px;">
            <div id="lvl-bar" style="height: 100%; background: #a78bfa; width: 0%;"></div>
        </div>

        <div id="coin">üíé</div>

        <div style="font-size: 26px; font-weight: bold; color: #34d399;">‚ö° <span id="energy">250</span></div>
        <div style="font-size: 11px; color: #94a3b8;">250 —ç–Ω–µ—Ä–≥–∏–∏ / 30 –º–∏–Ω</div>
    </div>

    <div id="tab-games" class="tab-content">
        <div id="games-list" class="game-shelf">
            <div class="glass-card" onclick="startUIGame('mines')">
                <div><b>üí£ –ú–ò–ù–´</b><br><small style="color:#94a3b8">–£–º–Ω–æ–∂–∞–π TON</small></div>
                <b>‚ñ∂</b>
            </div>
            <div class="glass-card" onclick="startUIGame('ladder')">
                <div><b>ü™ú –õ–ï–°–ï–ù–ö–ê</b><br><small style="color:#94a3b8">–ü–æ–¥–Ω–∏–º–∞–π—Å—è –≤—ã—à–µ</small></div>
                <b>‚ñ∂</b>
            </div>
            <div class="glass-card" onclick="startUIGame('bj')">
                <div><b>üÉè –ë–õ–≠–ö–î–ñ–ï–ö</b><br><small style="color:#94a3b8">–û–±—ã–≥—Ä–∞–π –¥–∏–ª–µ—Ä–∞</small></div>
                <b>‚ñ∂</b>
            </div>
        </div>

        <div id="game-active-area" style="display:none; width: 100%;">
            <h2 id="g-title">–ò–≥—Ä–∞</h2>
            <div id="g-play-field"></div>
            <div id="g-stats" style="margin: 15px 0; color: #f59e0b; font-weight: bold; min-height: 20px;"></div>
            <button id="btn-cashout" class="btn btn-orange" style="display:none" onclick="cashoutGame()">–ó–ê–ë–†–ê–¢–¨</button>
            <button class="btn btn-red" onclick="closeGame()">–í–´–ô–¢–ò</button>
        </div>
    </div>

    <div id="tab-profile" class="tab-content">
        <div class="prof-box">
            <h2 style="margin: 0;">–ò–≥—Ä–æ–∫ <span id="vip-tag" style="display:none; color:#f59e0b">üëë VIP</span></h2>
            <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                <div><b id="p-games">0</b><br><small>–ò–≥—Ä</small></div>
                <div><b id="p-wins">0</b><br><small>–ü–æ–±–µ–¥</small></div>
                <div><b id="p-wr">0%</b><br><small>WinRate</small></div>
            </div>
        </div>

        <div class="glass-card" style="flex-direction: column; text-align: left; gap: 10px;">
            <b style="color: #0098EA;">–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ VIP –ø–æ–¥–ø–∏—Å–∫–∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:</b>
            <div style="font-size: 13px; line-height: 1.5;">
                ‚Ä¢ 1 —Ç–∞–ø = 1.5 TON<br>
                ‚Ä¢ –õ–∏–º–∏—Ç —ç–Ω–µ—Ä–≥–∏–∏: +10,000 –∫ —Ç–µ–∫—É—â–µ–º—É<br>
                ‚Ä¢ –§–∞—Ä–º 250 —ç–Ω–µ—Ä–≥–∏–∏ –∑–∞ 10 –º–∏–Ω—É—Ç<br>
                ‚Ä¢ –ó–Ω–∞—á–æ–∫ VIP –≤ –ø—Ä–æ—Ñ–∏–ª–µ
            </div>
            <button class="btn btn-blue" onclick="tg.openTelegramLink('https://t.me/fresei')">–ö—É–ø–∏—Ç—å VIP</button>
        </div>
    </div>

    <div id="tab-admin" class="tab-content">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (ID –∏–ª–∏ –Æ–∑–µ—Ä–Ω–µ–π–º)</h3>
        <input type="text" id="adm-target" class="input-dark" placeholder="ID –∏–≥—Ä–æ–∫–∞">
        <input type="number" id="adm-val" class="input-dark" placeholder="–°—É–º–º–∞ TON / –õ–∏–º–∏—Ç">
        <button class="btn btn-blue" onclick="adminGo('money')">–í—ã–¥–∞—Ç—å TON</button>
        <button class="btn btn-orange" onclick="adminGo('vip')">–í—ã–¥–∞—Ç—å VIP</button>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('farm', this)"><b>üíé</b>–§–∞—Ä–º</div>
        <div class="nav-item" onclick="switchTab('games', this)"><b>üé≤</b>–ò–≥—Ä—ã</div>
        <div class="nav-item" onclick="switchTab('profile', this)"><b>üë§</b>–ü—Ä–æ—Ñ–∏–ª—å</div>
        <div id="adm-btn" class="nav-item" style="display:none" onclick="switchTab('admin', this)"><b>‚öôÔ∏è</b>–ê–¥–º–∏–Ω</div>
    </div>

    <script>
        const ADMINS = [7177436669, 8388334620];
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe?.user?.id || 0;
        tg.expand();

        let db = JSON.parse(localStorage.getItem('ton_v6')) || {
            bal: 100, clk: 0, nrg: 250, last: Date.now(), vip: false, games: 0, wins: 0
        };

        let cur = { active: false, bet: 0, mult: 1, type: '', step: 0, data: null };

        function save() { localStorage.setItem('ton_v6', JSON.stringify(db)); }

        function updateUI() {
            let now = Date.now();
            let maxNrg = db.vip ? 10250 : 250;
            let regRate = db.vip ? (250/600) : (250/1800);
            db.nrg = Math.min(maxNrg, db.nrg + ((now - db.last)/1000 * regRate));
            db.last = now;

            document.getElementById('balance').innerText = db.bal.toFixed(2);
            document.getElementById('energy').innerText = Math.floor(db.nrg);
            
            let lvl = Math.floor(db.clk / 15000) + 1;
            document.getElementById('lvl-text').innerText = `–£—Ä–æ–≤–µ–Ω—å ${lvl}`;
            document.getElementById('lvl-remain').innerText = `–¥–æ –∞–ø–ø–∞: ${(lvl * 15000 - db.clk).toLocaleString()}`;
            document.getElementById('lvl-bar').style.width = ((db.clk % 15000) / 15000 * 100) + '%';

            document.getElementById('p-games').innerText = db.games;
            document.getElementById('p-wins').innerText = db.wins;
            document.getElementById('p-wr').innerText = db.games > 0 ? Math.round(db.wins/db.games*100)+'%' : '0%';
            document.getElementById('vip-tag').style.display = db.vip ? 'inline' : 'none';

            if(ADMINS.includes(userId)) document.getElementById('adm-btn').style.display = 'block';
            save();
        }

        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('tab-' + id).classList.add('active-tab');
            el.classList.add('active');
            closeGame();
        }

        // --- –ò–ì–†–´ (–§–ò–ö–° –ë–ê–ì–û–í) ---
        function startUIGame(type) {
            document.getElementById('games-list').style.display = 'none';
            document.getElementById('game-active-area').style.display = 'block';
            cur.type = type;
            let field = document.getElementById('g-play-field');
            
            if(type === 'mines') {
                document.getElementById('g-title').innerText = "–ú–ò–ù–´";
                field.innerHTML = `
                    <input type="number" id="bet" class="input-dark" placeholder="–°—Ç–∞–≤–∫–∞ TON">
                    <input type="number" id="m-count" class="input-dark" placeholder="–ú–∏–Ω (1-24)" value="3">
                    <button class="btn btn-blue" onclick="playMines()">–ù–ê–ß–ê–¢–¨</button>
                    <div id="m-grid" class="mines-grid"></div>
                `;
            } else if(type === 'ladder') {
                document.getElementById('g-title').innerText = "–õ–ï–°–ï–ù–ö–ê";
                field.innerHTML = `
                    <input type="number" id="bet" class="input-dark" placeholder="–°—Ç–∞–≤–∫–∞ TON">
                    <button class="btn btn-blue" onclick="playLadder()">–ù–ê–ß–ê–¢–¨</button>
                    <div id="l-grid" class="ladder-grid"></div>
                `;
            } else if(type === 'bj') {
                document.getElementById('g-title').innerText = "–ë–õ–≠–ö–î–ñ–ï–ö";
                field.innerHTML = `<input type="number" id="bet" class="input-dark" placeholder="–°—Ç–∞–≤–∫–∞ TON"><button class="btn btn-blue" onclick="playBJ()">–ò–ì–†–ê–¢–¨</button>`;
            }
        }

        function playMines() {
            let b = parseFloat(document.getElementById('bet').value);
            let c = parseInt(document.getElementById('m-count').value);
            if(b > db.bal || b <= 0 || c < 1 || c > 24) return alert("–û—à–∏–±–∫–∞!");
            db.bal -= b; db.games++; cur = { active: true, bet: b, mult: 1, type: 'mines', data: Array(25).fill(false), step: c };
            let p = 0; while(p < c) { let r = Math.floor(Math.random()*25); if(!cur.data[r]){cur.data[r]=true; p++;} }
            
            let grid = document.getElementById('m-grid'); grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let div = document.createElement('div'); div.className = 'm-cell'; div.innerText = '?';
                div.onclick = () => {
                    if(!cur.active || div.innerText !== '?') return;
                    if(cur.data[i]) {
                        div.innerText = 'üí£'; div.style.background = '#ef4444'; cur.active = false;
                        document.getElementById('g-stats').innerText = "–ü–†–û–ò–ì–†–´–®!";
                        document.getElementById('btn-cashout').style.display = 'none';
                    } else {
                        div.innerText = 'üíé'; div.style.background = '#10b981';
                        cur.mult += (c/5) + 0.2;
                        document.getElementById('g-stats').innerText = `–ö—É—à: ${(cur.bet * cur.mult).toFixed(2)} | –°–ª–µ–¥: x${(cur.mult + (c/5) + 0.2).toFixed(2)}`;
                        document.getElementById('btn-cashout').style.display = 'block';
                    }
                };
                grid.appendChild(div);
            }
            updateUI();
        }

        function playLadder() {
            let b = parseFloat(document.getElementById('bet').value);
            if(b > db.bal || b <= 0) return alert("–ú–∞–ª–æ TON");
            db.bal -= b; db.games++; cur = { active: true, bet: b, mult: 1.2, type: 'ladder', step: 0 };
            let grid = document.getElementById('l-grid'); grid.innerHTML = '';
            for(let i=0; i<6; i++) {
                let row = document.createElement('div'); row.className = 'ladder-row' + (i>0?' locked':'');
                let t = Math.floor(Math.random()*2);
                row.innerHTML = `<div class="l-cell" onclick="stepL(0,${t},${i},this)">?</div><div class="l-cell" onclick="stepL(1,${t},${i},this)">?</div>`;
                grid.appendChild(row);
            }
            updateUI();
        }

        function stepL(choice, trap, idx, el) {
            if(!cur.active || idx !== cur.step) return;
            if(choice === trap) { el.innerText = 'üí•'; cur.active = false; document.getElementById('g-stats').innerText = "–£–ü–ê–õ!"; document.getElementById('btn-cashout').style.display = 'none'; }
            else { 
                el.innerText = 'üíé'; el.style.background = '#10b981'; cur.mult *= 2; cur.step++;
                document.getElementById('btn-cashout').style.display = 'block';
                document.getElementById('g-stats').innerText = `–í—ã–ø–ª–∞—Ç–∞: ${(cur.bet * cur.mult).toFixed(2)}`;
                if(cur.step < 6) document.querySelectorAll('.ladder-row')[cur.step].classList.remove('locked');
            }
        }

        function playBJ() {
            let b = parseFloat(document.getElementById('bet').value);
            if(b > db.bal || b <= 0) return alert("–ú–∞–ª–æ TON");
            db.bal -= b; db.games++;
            let p = Math.floor(Math.random()*11)+10; let d = Math.floor(Math.random()*11)+11;
            if(p > d) { db.bal += b*2; db.wins++; alert(`–ü–æ–±–µ–¥–∞! –í—ã: ${p}, –î–∏–ª–µ—Ä: ${d}`); }
            else alert(`–°–ª–∏–≤! –í—ã: ${p}, –î–∏–ª–µ—Ä: ${d}`);
            updateUI();
        }

        function cashoutGame() {
            if(!cur.active) return;
            db.bal += cur.bet * cur.mult; db.wins++; cur.active = false;
            alert("–ó–∞–±—Ä–∞–ª " + (cur.bet * cur.mult).toFixed(2));
            closeGame(); updateUI();
        }

        function closeGame() {
            document.getElementById('games-list').style.display = 'flex';
            document.getElementById('game-active-area').style.display = 'none';
            document.getElementById('btn-cashout').style.display = 'none';
            document.getElementById('g-stats').innerText = '';
            cur.active = false;
        }

        function adminGo(type) {
            let t = document.getElementById('adm-target').value;
            let v = parseFloat(document.getElementById('adm-val').value);
            if(t == userId || t == "@me") {
                if(type==='money') db.bal += v;
                else db.vip = true;
                updateUI(); alert("–û–∫!");
            }
        }

        document.getElementById('coin').onclick = () => {
            if(db.nrg >= 1) { db.nrg--; db.clk++; db.bal += db.vip ? 1.5 : 0.5; updateUI(); }
        };

        setInterval(updateUI, 1000);
        updateUI();
    </script>
</body>
</html>
